<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Architecture &#8212; Conestack</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a075eb5b" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="_static/pygments_dark.css?v=20074c1a" />
    <link rel="stylesheet" type="text/css" href="_static/css/conestack.css?v=53c11f18" />
    <script src="_static/documentation_options.js?v=60dbed4a"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Package Validation" href="package_validation.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
<link rel="stylesheet" type="text/css" src="_static/bootstrap/bootstrap.css" />
<script src="_static/bootstrap/bootstrap.bundle.min.js"></script>
<script src="_static/js/conestack.js"></script>
<script src="_static/js/colortoggle.js"></script>

  </head><body>

  <noscript>
    <style type="text/css">
      #searchbox,
      #searchdesc {
        display: none;
      }
      @media (max-width: 768px) {
        #navbar-toggle {
          display: none;
        }
        #cs-mobile-menu {
          display: block;
        }
        #cs-layout {
          margin-top: 12rem;
        }
        #cs-ext-links {
          margin-right: 2rem!important;
        }
      }
    </style>
  </noscript>

  
  <header class="navbar navbar-expand-md sticky-top" id="header">
    <nav class="container-xxl flex-wrap flex-md-nowrap p-0" id="cs-nav">
  <a id="logo" class="navbar-brand p-0 me-2" href="index.html">
    <img src="_static/conestack.svg"
         alt="Logo"
         width="50px"
         height="50px" />
    <span>conestack</span>
  </a>

      
  <div id="nav-search" class="ms-auto">
    <div id="searchbox" class="nav-item me-3" role="search" style="display: none;">
      <form class="search input-group" action="search.html" method="get">
        <input type="text" class="form-control" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
        <button type="submit" 
                class="bi bi-search input-group-text"
                btn-title="Search documentation"></button>
      </form>
    </div>
  </div>
      
  <div id="cs-ext-links"class="me-3">
    <ul class="navbar-nav flex-row ms-md-auto">
  <li class="nav-item" data-title="GitHub">
    <a class="nav-link p-2" href="https://github.com/conestack/conestack" target="_blank" rel="noopener">
      <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" class="navbar-nav-svg d-inline-block align-text-top" viewBox="0 0 512 499.36" role="img"><title>GitHub</title><path fill="currentColor" fill-rule="evenodd" d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z"></path></svg>
    </a>
  </li>

    </ul>
  </div>


      <div id="colortoggler-wrapper">
        <div id="colortoggler"
             class="nav-item dropdown align-items-center h-100 p-0 form-check form-switch me-4">
          <i class="bi-sun-fill me-2"></i>
          <div class="form-check form-switch m-0 d-inline-block">
            <input class="form-check-input" type="checkbox" id="colortoggle-switch">
          </div>
          <i class="bi-moon-fill"></i>
        </div>
      </div>

      <button id="navbar-toggle" class="navbar-toggler p-0 me-4" type="button" data-bs-toggle="collapse" data-bs-target="#cs-mobile-menu">
        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" class="bi" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 11.5A.5.5 0 0 1 3 11h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4A.5.5 0 0 1 3 3h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"></path></svg>
      </button>

      <div class="collapse container-fluid m-0 p-3" id="cs-mobile-menu"><nav class="cs-mobile-toc">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="package_validation.html">Package Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Version Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions_1.0.html">Conestack 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions_2.0.html">Conestack 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions_3.0.html">Conestack 3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="versions_outdated.html">Outdated Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="version_mapping.html">Version Mapping</a></li>
</ul>

</nav>
      </div>
    </nav>
  </header>
  

  <div class="container-xxl my-md-4" id="cs-layout">
    
  <aside id="cs-sidebar" class="ms-4 sphinxsidebar"><nav class="cs-nav-toc">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#about-conestack">About Conestack</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#package-families">Package Families</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#the-monorepo">The Monorepo</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#working-with-the-repository">Working with the Repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#working-with-documentation">Working with Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#python-version-support">Python Version Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#plumber-behavior-composition">plumber - Behavior Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#node-tree-data-structures">node - Tree Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#node-ext-backend-extensions">node.ext.* - Backend Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#yafowil-form-library">yafowil - Form Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="#yafowil-widget-widget-extensions">yafowil.widget.* - Widget Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cone-app-web-application-framework">cone.app - Web Application Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cone-feature-packages">cone.* - Feature Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#architecture-summary">Architecture Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="package_validation.html">Package Validation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#purpose">Purpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#validation-script">Validation Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#make-targets">Make Targets</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#test-blacklist">Test Blacklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#sequential-test-packages">Sequential Test Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#test-execution-model">Test Execution Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#artifact-comparison">Artifact Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="package_validation.html#key-design-points">Key Design Points</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release Process</a><ul>
<li class="toctree-l2"><a class="reference internal" href="release.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#automated-release">Automated Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#manual-release-single-package">Manual Release (Single Package)</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#release-order">Release Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#detection-logic">Detection Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#post-release-verification">Post-Release Verification</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html#troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="versions.html">Version Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="versions.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions.html#version-history">Version History</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions.html#bootstrap-transition">Bootstrap Transition</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions.html#python-version-support">Python Version Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions.html#package-status">Package Status</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="versions_1.0.html">Conestack 1.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="versions_1.0.html#not-yet-supported">Not Yet Supported</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="versions_2.0.html">Conestack 2.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="versions_2.0.html#new-packages">New Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions_2.0.html#removed-packages">Removed Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions_2.0.html#version-changes">Version Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="versions_3.0.html">Conestack 3.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="versions_3.0.html#version-changes">Version Changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="versions_3.0.html#unchanged-packages">Unchanged Packages</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="versions_outdated.html">Outdated Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="version_mapping.html">Version Mapping</a><ul>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#core-packages">Core Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#node-extensions">Node Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#cone-framework">Cone Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#yafowil-core">YAFOWIL Core</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#yafowil-widgets">YAFOWIL Widgets</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#supporting-packages">Supporting Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="version_mapping.html#status-legend">Status Legend</a></li>
</ul>
</li>
</ul>

</nav>
    
  </aside>
    

    
      <main class="document cs-main order-1" role="main">
    
      <div class="ps-lg-4 mt-3 cs-content">
        
  <section id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Link to this heading">#</a></h1>
<p>This document describes the architecture of the Conestack core packages and how
they work together to form a cohesive web application framework.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The Conestack ecosystem consists of packages for different application domains.
Each package addresses a specific concern and can be used independently, though
they integrate when used together.</p>
<p><strong>Application Domains</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Domain</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>plumber</strong></p></td>
<td><p>Behavior composition for classes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>node</strong></p></td>
<td><p>Tree-based data structures</p></td>
</tr>
<tr class="row-even"><td><p><strong>yafowil</strong></p></td>
<td><p>Form processing and validation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>cone.app</strong></p></td>
<td><p>Web application framework</p></td>
</tr>
</tbody>
</table>
<p><strong>Dependency Structure</strong></p>
<p>When used together, the packages have the following dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌─────────────────────────────────────────────────────────────┐
│                       cone.app                              │
│            Web Framework, Tiles, Security                   │
└─────────────────────────────────────────────────────────────┘
         │                                     │
         ▼                                     ▼
┌─────────────────────────┐     ┌─────────────────────────────┐
│         node            │     │          yafowil            │
│   Tree Structures       │◄────│   Form Processing           │
└─────────────────────────┘     └─────────────────────────────┘
          │                                    │
          └──────────────┬─────────────────────┘
                         ▼
┌─────────────────────────────────────────────────────────────┐
│                        plumber                              │
│                 Behavior Composition                        │
└─────────────────────────────────────────────────────────────┘
</pre></div>
</div>
</section>
<section id="plumber-behavior-composition">
<h2>plumber - Behavior Composition<a class="headerlink" href="#plumber-behavior-composition" title="Link to this heading">#</a></h2>
<p><strong>plumber</strong> is a library for composition-based class extension as an alternative
to mixins. It addresses requirements of behavior composition that are difficult
to achieve with traditional inheritance, such as explicit precedence control
and method pipelines, through a two-stage instruction system.</p>
<section id="package-structure">
<h3>Package Structure<a class="headerlink" href="#package-structure" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>src/plumber/
├── __init__.py      # Public API
├── plumber.py       # Metaclass and @plumbing decorator
├── behavior.py      # Behavior base class and metaclass
├── instructions.py  # All instructions (decorators)
└── exceptions.py    # PlumbingCollision
</pre></div>
</div>
</section>
<section id="core-concepts">
<h3>Core Concepts<a class="headerlink" href="#core-concepts" title="Link to this heading">#</a></h3>
<p><strong>Two-Stage Processing</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Timing</p></th>
<th class="head"><p>Instructions</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Stage 1</p></td>
<td><p>Before class creation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">override</span></code>,
<code class="docutils literal notranslate"><span class="pre">finalize</span></code></p></td>
<td><p>Attribute extension</p></td>
</tr>
<tr class="row-odd"><td><p>Stage 2</p></td>
<td><p>After class creation</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">plumb</span></code>, <code class="docutils literal notranslate"><span class="pre">plumbifexists</span></code></p></td>
<td><p>Method pipelines</p></td>
</tr>
</tbody>
</table>
<p><strong>Precedence Hierarchy (Stage 1)</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">finalize</span> <span class="o">&gt;</span> <span class="n">override</span> <span class="o">&gt;</span> <span class="n">default</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">default</span></code>: Weakest extension - only if attribute undefined</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">override</span></code>: Medium strength - overrides base class, can be overridden by <code class="docutils literal notranslate"><span class="pre">finalize</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">finalize</span></code>: Strongest extension - cannot be overridden</p></li>
</ul>
<p><strong>Pipeline Creation (Stage 2)</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyBehavior</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="nd">@plumb</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">method</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">):</span>
        <span class="c1"># next_ calls the next method in the pipeline</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">next_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">modified_result</span>
</pre></div>
</div>
</section>
<section id="main-classes">
<h3>Main Classes<a class="headerlink" href="#main-classes" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">plumber</span></code> (metaclass)</p></td>
<td><p>Controls class creation, applies
instructions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">plumbing</span></code> (decorator)</p></td>
<td><p>Decorator API for applying behaviors</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Behavior</span></code></p></td>
<td><p>Base class for all behaviors</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Instruction</span></code></p></td>
<td><p>Abstract base class for instructions</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">override</span></code>, <code class="docutils literal notranslate"><span class="pre">finalize</span></code></p></td>
<td><p>Stage 1 instructions</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">plumb</span></code>, <code class="docutils literal notranslate"><span class="pre">plumbifexists</span></code></p></td>
<td><p>Stage 2 instructions</p></td>
</tr>
</tbody>
</table>
</section>
<section id="usage-example">
<h3>Usage Example<a class="headerlink" href="#usage-example" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">plumber</span><span class="w"> </span><span class="kn">import</span> <span class="n">plumbing</span><span class="p">,</span> <span class="n">Behavior</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">override</span><span class="p">,</span> <span class="n">plumb</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LoggingBehavior</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="nd">@plumb</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">next_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ValidationBehavior</span><span class="p">(</span><span class="n">Behavior</span><span class="p">):</span>
    <span class="n">valid</span> <span class="o">=</span> <span class="n">default</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@plumb</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="n">next_</span><span class="p">,</span> <span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">next_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="nd">@plumbing</span><span class="p">(</span><span class="n">LoggingBehavior</span><span class="p">,</span> <span class="n">ValidationBehavior</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Actual save logic</span>
        <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="design-patterns">
<h3>Design Patterns<a class="headerlink" href="#design-patterns" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Metaclass Pattern</strong> - Central class creation control</p></li>
<li><p><strong>Decorator Pattern</strong> - <code class="docutils literal notranslate"><span class="pre">&#64;plumbing</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;default</span></code>, <code class="docutils literal notranslate"><span class="pre">&#64;override</span></code>, etc.</p></li>
<li><p><strong>Chain of Responsibility</strong> - Pipeline execution in <code class="docutils literal notranslate"><span class="pre">plumb</span></code></p></li>
<li><p><strong>Composite Pattern</strong> - Instructions combined via <code class="docutils literal notranslate"><span class="pre">__add__</span></code></p></li>
</ul>
</section>
</section>
<section id="node-tree-data-structures">
<h2>node - Tree Data Structures<a class="headerlink" href="#node-tree-data-structures" title="Link to this heading">#</a></h2>
<p><strong>node</strong> is a library for tree-based data structures that implements the Zope
Location Protocol. It is built on plumber behaviors.</p>
<section id="id1">
<h3>Package Structure<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>src/node/
├── base.py              # Pre-built node classes
├── interfaces.py        # ~40 interface definitions
├── events.py            # Event classes and dispatcher
├── utils.py             # Helper functions
├── locking.py           # Locking utilities
├── serializer.py        # Tree serialization
├── behaviors/           # ~21 plumber behaviors
│   ├── storage.py       # Dict/Odict/List storage
│   ├── node.py          # Core node behavior
│   ├── mapping.py       # Mapping protocol chain
│   ├── sequence.py      # Sequence protocol chain
│   ├── adopt.py         # Automatic child adoption
│   ├── constraints.py   # Child validation
│   ├── lifecycle.py     # Lifecycle events
│   ├── reference.py     # UUID-based index
│   ├── order.py         # Ordering operations
│   ├── attributes.py    # Metadata storage
│   ├── schema.py        # Typed fields
│   ├── factories.py     # Dynamic child creation
│   └── ...              # Additional behaviors
└── schema/              # Schema validation
    ├── fields.py        # Field types
    └── serializer.py    # Field serializers
</pre></div>
</div>
</section>
<section id="id2">
<h3>Core Concepts<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p><strong>Zope Location Protocol</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="vm">__name__</span>    <span class="c1"># Name in parent</span>
<span class="n">node</span><span class="o">.</span><span class="n">__parent__</span>  <span class="c1"># Reference to parent</span>
<span class="n">node</span><span class="o">.</span><span class="n">path</span>        <span class="c1"># Path from root to here</span>
<span class="n">node</span><span class="o">.</span><span class="n">root</span>        <span class="c1"># Root node</span>
<span class="n">node</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">interface</span><span class="p">)</span>  <span class="c1"># Parent traversal</span>
</pre></div>
</div>
<p><strong>Storage Types</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Storage Type</p></th>
<th class="head"><p>Classes</p></th>
<th class="head"><p>Interface</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Mapping (dict)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BaseNode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IMappingNode</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Mapping (odict)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">OrderedNode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">IMappingNode</span></code> + <code class="docutils literal notranslate"><span class="pre">IOrdered</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Sequence (list)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ListNode</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ISequenceNode</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Behavior Layers (Pipeline from Top to Bottom)</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Constraints     → Validation before child addition
Adoption        → Sets __name__ and __parent__
Lifecycle       → Fires events on changes
References      → Maintains UUID index
Attributes      → Separate metadata node
Schema          → Type validation &amp; serialization
Factories       → Dynamic child creation
Order           → Ordering operations
Node            → Tree hierarchy &amp; properties
Mapping/Seq     → Dict/list-like API
Storage         → Data backend (dict/odict/list)
</pre></div>
</div>
</section>
<section id="pre-built-node-classes">
<h3>Pre-built Node Classes<a class="headerlink" href="#pre-built-node-classes" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">node.base</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">AbstractNode</span><span class="p">,</span>    <span class="c1"># Minimal: only adoption + node hierarchy</span>
    <span class="n">BaseNode</span><span class="p">,</span>        <span class="c1"># Unordered, dict-based</span>
    <span class="n">OrderedNode</span><span class="p">,</span>     <span class="c1"># Ordered, odict-based</span>
    <span class="n">ListNode</span><span class="p">,</span>        <span class="c1"># Sequence-based</span>
    <span class="n">Node</span><span class="p">,</span>            <span class="c1"># With all standard behaviors (legacy)</span>
    <span class="n">AttributedNode</span><span class="p">,</span>  <span class="c1"># Alias for Node</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="custom-node-creation">
<h3>Custom Node Creation<a class="headerlink" href="#custom-node-creation" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">plumber</span><span class="w"> </span><span class="kn">import</span> <span class="n">plumbing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">node.behaviors</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">MappingConstraints</span><span class="p">,</span> <span class="n">MappingAdopt</span><span class="p">,</span> <span class="n">DefaultInit</span><span class="p">,</span>
    <span class="n">MappingNode</span><span class="p">,</span> <span class="n">OdictStorage</span><span class="p">,</span> <span class="n">MappingReference</span><span class="p">,</span>
<span class="p">)</span>

<span class="nd">@plumbing</span><span class="p">(</span>
    <span class="n">MappingConstraints</span><span class="p">,</span>
    <span class="n">MappingAdopt</span><span class="p">,</span>
    <span class="n">DefaultInit</span><span class="p">,</span>
    <span class="n">MappingNode</span><span class="p">,</span>
    <span class="n">MappingReference</span><span class="p">,</span>
    <span class="n">OdictStorage</span><span class="p">,</span>
<span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyNode</span><span class="p">:</span>
    <span class="n">child_constraints</span> <span class="o">=</span> <span class="p">(</span><span class="n">IMyInterface</span><span class="p">,)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Design Patterns<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Pattern</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Composite</strong></p></td>
<td><p>Tree structure of nodes</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Plugin/Strategy</strong></p></td>
<td><p>Behaviors as interchangeable strategies</p></td>
</tr>
<tr class="row-even"><td><p><strong>Chain of Responsibility</strong></p></td>
<td><p>Plumber pipeline</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Decorator</strong></p></td>
<td><p>Behavior layers wrap each other</p></td>
</tr>
<tr class="row-even"><td><p><strong>Observer</strong></p></td>
<td><p>Lifecycle events</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Lazy Loading</strong></p></td>
<td><p>Factory behaviors</p></td>
</tr>
<tr class="row-even"><td><p><strong>Index</strong></p></td>
<td><p>Reference system with UUID lookup</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="node-ext-backend-extensions">
<h2>node.ext.* - Backend Extensions<a class="headerlink" href="#node-ext-backend-extensions" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">node.ext.*</span></code> packages provide adapters to expose various backend systems
as node trees:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.directory</span></code></p></td>
<td><p>File system directories as traversable tree
structures</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.fs</span></code></p></td>
<td><p>File system nodes with content access</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.ldap</span></code></p></td>
<td><p>LDAP directories as node trees with full CRUD
operations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.ugm</span></code></p></td>
<td><p>Abstract user/group management with pluggable
backends</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.yaml</span></code></p></td>
<td><p>YAML files as persistent node storage</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node.ext.zodb</span></code></p></td>
<td><p>ZODB persistent object storage integration</p></td>
</tr>
</tbody>
</table>
<p>These extensions allow applications to work with different storage backends
using the same node API.</p>
</section>
<section id="yafowil-form-library">
<h2>yafowil - Form Library<a class="headerlink" href="#yafowil-form-library" title="Link to this heading">#</a></h2>
<p><strong>yafowil</strong> (Yet Another Form Widget Library) is a declarative, composition-based
form library. Instead of inheriting widget classes, widgets are composed via a
<strong>Factory</strong> from <strong>Blueprints</strong>.</p>
<section id="id4">
<h3>Package Structure<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>src/yafowil/
├── base.py           # Widget, RuntimeData, Factory, ExtractionError
├── controller.py     # Form controller for submissions
├── datatypes.py      # Data type conversion
├── persistence.py    # Persistence writers
├── utils.py          # Tag class, vocabularies, CSS helpers
├── loader.py         # Plugin system via entry points
├── common.py         # Generic extractors/renderers
├── compound.py       # Form, Fieldset, Div
├── field.py          # Label, Help, Error wrapper
├── text.py           # Text input blueprint
├── select.py         # Select/Dropdown blueprints
├── checkbox.py       # Checkbox blueprint
├── textarea.py       # Textarea blueprint
├── button.py         # Submit/Button blueprints
├── file.py           # File upload blueprint
└── ...               # Additional blueprints
</pre></div>
</div>
</section>
<section id="id5">
<h3>Core Concepts<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<p><strong>Blueprint System</strong></p>
<p>Blueprints are registered components with extractors, renderers, and preprocessors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
    <span class="s1">&#39;text&#39;</span><span class="p">,</span>
    <span class="n">extractors</span><span class="o">=</span><span class="p">[</span><span class="n">generic_extractor</span><span class="p">,</span> <span class="n">generic_required_extractor</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span>
    <span class="n">edit_renderers</span><span class="o">=</span><span class="p">[</span><span class="n">text_edit_renderer</span><span class="p">],</span>
    <span class="n">display_renderers</span><span class="o">=</span><span class="p">[</span><span class="n">generic_display_renderer</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p><strong>Blueprint Composition (Chain Syntax)</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single blueprint</span>
<span class="n">factory</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>

<span class="c1"># Multiple blueprints combined</span>
<span class="n">factory</span><span class="p">(</span><span class="s1">&#39;error:label:text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>  <span class="c1"># Error → Label → Text</span>
<span class="n">factory</span><span class="p">(</span><span class="s1">&#39;field:label:text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>  <span class="c1"># Field-Wrapper → Label → Text</span>
</pre></div>
</div>
<p><strong>Dual Pipeline Architecture</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Pipeline</p></th>
<th class="head"><p>Direction</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Extraction</strong></p></td>
<td><p>Request → Data</p></td>
<td><p>Extract values, validate</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Rendering</strong></p></td>
<td><p>Data → HTML</p></td>
<td><p>Generate HTML</p></td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Extraction:  Request → [Extractor₁ → Extractor₂ → ... → Extractorₙ] → Validated Data
                              ↓ ExtractionError stops at abort=True

Rendering:   Data → [Renderer₁ → Renderer₂ → ... → Rendererₙ] → HTML
                         ↓ Each renderer wraps previous output
</pre></div>
</div>
<p><strong>Node Integration</strong></p>
<p>Widget and RuntimeData use node behaviors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@plumbing</span><span class="p">(</span>
    <span class="n">Attributes</span><span class="p">,</span>
    <span class="n">MappingConstraints</span><span class="p">,</span>
    <span class="n">MappingAdopt</span><span class="p">,</span>
    <span class="n">MappingOrder</span><span class="p">,</span>
    <span class="n">MappingNode</span><span class="p">,</span>
    <span class="n">OdictStorage</span>
<span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Widget</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
</section>
<section id="id6">
<h3>Main Classes<a class="headerlink" href="#id6" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Widget</span></code></p></td>
<td><p>Configured widget node with chains</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">RuntimeData</span></code></p></td>
<td><p>Processing state during extract/render</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Factory</span></code></p></td>
<td><p>Registry and builder for widgets</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ExtractionError</span></code></p></td>
<td><p>Validation error with abort flag</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Controller</span></code></p></td>
<td><p>High-level form handling</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Tag</span></code></p></td>
<td><p>HTML generation without templates</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id7">
<h3>Usage Example<a class="headerlink" href="#id7" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">yafowil.base</span><span class="w"> </span><span class="kn">import</span> <span class="n">factory</span><span class="p">,</span> <span class="n">Controller</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">yafowil.persistence</span><span class="w"> </span><span class="kn">import</span> <span class="n">attribute_writer</span>

<span class="c1"># Create form</span>
<span class="n">form</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;contact&#39;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;form.action&#39;</span><span class="p">:</span> <span class="s1">&#39;/submit&#39;</span><span class="p">,</span>
    <span class="s1">&#39;form.method&#39;</span><span class="p">:</span> <span class="s1">&#39;post&#39;</span>
<span class="p">})</span>

<span class="c1"># Add child widgets</span>
<span class="n">form</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;error:label:text&#39;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;label.label&#39;</span><span class="p">:</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">})</span>

<span class="n">form</span><span class="p">[</span><span class="s1">&#39;email&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;error:label:email&#39;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;label.label&#39;</span><span class="p">:</span> <span class="s1">&#39;Email&#39;</span><span class="p">,</span>
    <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">})</span>

<span class="k">def</span><span class="w"> </span><span class="nf">handle_submit</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Submitted:&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">extracted</span><span class="p">)</span>

<span class="n">form</span><span class="p">[</span><span class="s1">&#39;submit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;submit&#39;</span><span class="p">,</span> <span class="n">props</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;submit.action&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;submit.handler&#39;</span><span class="p">:</span> <span class="n">handle_submit</span>
<span class="p">})</span>

<span class="c1"># Extraction and rendering</span>
<span class="n">request</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;contact.name&#39;</span><span class="p">:</span> <span class="s1">&#39;John&#39;</span><span class="p">,</span> <span class="s1">&#39;contact.email&#39;</span><span class="p">:</span> <span class="s1">&#39;john@example.com&#39;</span><span class="p">}</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>

<span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">has_errors</span><span class="p">:</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">form</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>  <span class="c1"># Render with errors</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">writer</span><span class="o">=</span><span class="n">attribute_writer</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="extension-mechanisms">
<h3>Extension Mechanisms<a class="headerlink" href="#extension-mechanisms" title="Link to this heading">#</a></h3>
<p><strong>Custom Blueprint</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@managedprops</span><span class="p">(</span><span class="s1">&#39;my_prop&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_extractor</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">valid</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">extracted</span><span class="p">):</span>
        <span class="k">raise</span> <span class="n">ExtractionError</span><span class="p">(</span><span class="s1">&#39;Invalid&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">extracted</span>

<span class="n">factory</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s1">&#39;mycustom&#39;</span><span class="p">,</span> <span class="n">extractors</span><span class="o">=</span><span class="p">[</span><span class="n">my_extractor</span><span class="p">],</span> <span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Asterisk Syntax (Inline Custom)</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">widget</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;label:*validate:text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">,</span> <span class="n">custom</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="p">([</span><span class="n">my_extractor</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="p">})</span>
</pre></div>
</div>
<p><strong>Macros</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">factory</span><span class="o">.</span><span class="n">register_macro</span><span class="p">(</span><span class="s1">&#39;required_text&#39;</span><span class="p">,</span> <span class="s1">&#39;error:label:text&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;required&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">})</span>
<span class="n">widget</span> <span class="o">=</span> <span class="n">factory</span><span class="p">(</span><span class="s1">&#39;#required_text&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;field&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Plugin System (Entry Points)</strong></p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[project.entry-points.</span><span class="s2">&quot;yafowil.plugin&quot;</span><span class="k">]</span>
<span class="n">register</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;mypackage:register&quot;</span>
</pre></div>
</div>
</section>
<section id="id8">
<h3>Design Patterns<a class="headerlink" href="#id8" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Pattern</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Factory</strong></p></td>
<td><p>Central widget creation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Chain of Responsibility</strong></p></td>
<td><p>Extractor/renderer pipelines</p></td>
</tr>
<tr class="row-even"><td><p><strong>Composite</strong></p></td>
<td><p>Widget tree via node</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Registry</strong></p></td>
<td><p>Blueprint registry in Factory</p></td>
</tr>
<tr class="row-even"><td><p><strong>Strategy</strong></p></td>
<td><p>Interchangeable persistence writers</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Decorator</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">&#64;managedprops</span></code> for property
documentation</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="yafowil-widget-widget-extensions">
<h2>yafowil.widget.* - Widget Extensions<a class="headerlink" href="#yafowil-widget-widget-extensions" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">yafowil.widget.*</span></code> packages provide specialized form widgets:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.ace</span></code></p></td>
<td><p>Ace code editor integration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.array</span></code></p></td>
<td><p>Dynamic array/list fields</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.autocomplete</span></code></p></td>
<td><p>Autocomplete text input</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.chosen</span></code></p></td>
<td><p>Chosen.js select enhancement</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.color</span></code></p></td>
<td><p>Color picker widget</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.cron</span></code></p></td>
<td><p>Cron expression editor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.datetime</span></code></p></td>
<td><p>Date and time pickers</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.dict</span></code></p></td>
<td><p>Key-value dictionary fields</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.dynatree</span></code></p></td>
<td><p>Tree selection widget</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.image</span></code></p></td>
<td><p>Image upload and preview</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.location</span></code></p></td>
<td><p>Location/address picker with maps</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.multiselect</span></code></p></td>
<td><p>Multi-select list widget</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.richtext</span></code></p></td>
<td><p>Rich text editor integration</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.select2</span></code></p></td>
<td><p>Select2.js integration</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.slider</span></code></p></td>
<td><p>Range slider widget</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.tiptap</span></code></p></td>
<td><p>Tiptap rich text editor</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">yafowil.widget.wysihtml5</span></code></p></td>
<td><p>WYSIHTML5 editor integration</p></td>
</tr>
</tbody>
</table>
<p>Each widget package registers its blueprints via the yafowil plugin system,
making them automatically available after installation.</p>
</section>
<section id="cone-app-web-application-framework">
<h2>cone.app - Web Application Framework<a class="headerlink" href="#cone-app-web-application-framework" title="Link to this heading">#</a></h2>
<p><strong>cone.app</strong> is the main web application framework of the Conestack ecosystem.
It builds on Pyramid and integrates the other packages, providing tile-based
UI composition, ACL-based security, and a plugin architecture.</p>
<section id="id9">
<h3>Package Structure<a class="headerlink" href="#id9" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>src/cone/app/
├── __init__.py          # WSGI app factory, configuration, bootstrapping
├── model.py             # Core node models and behaviors
├── security.py          # Authentication, authorization, ACLs
├── interfaces.py        # Zope interface definitions
├── workflow.py          # Workflow state management
├── ugm.py               # User/group management backend
├── utils.py             # Helper functions
├── browser/             # Views, tiles, UI components
│   ├── __init__.py      # Main view, layout helpers
│   ├── actions.py       # Action system (toolbars, buttons)
│   ├── layout.py        # Layout tiles (navbar, menu, sidebar)
│   ├── contents.py      # Content listing table
│   ├── authoring.py     # Add/Edit forms
│   ├── ajax.py          # AJAX rendering and continuations
│   ├── sharing.py       # ACL editor
│   ├── form.py          # Yafowil integration
│   └── ...              # Additional browser modules
└── testing/             # Test utilities
</pre></div>
</div>
</section>
<section id="id10">
<h3>Core Concepts<a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<p><strong>Node-based Content Model</strong></p>
<p>All content is represented as nodes in a tree structure (like a file system):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">root</span> <span class="o">=</span> <span class="n">get_root</span><span class="p">()</span>
<span class="n">root</span><span class="p">[</span><span class="s1">&#39;documents&#39;</span><span class="p">][</span><span class="s1">&#39;report&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DocumentNode</span><span class="p">()</span>

<span class="c1"># Navigation via traversal</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">root</span><span class="p">[</span><span class="s1">&#39;documents&#39;</span><span class="p">][</span><span class="s1">&#39;report&#39;</span><span class="p">]</span>
<span class="n">node</span><span class="o">.</span><span class="n">path</span>      <span class="c1"># [&#39;&#39;, &#39;documents&#39;, &#39;report&#39;]</span>
<span class="n">node</span><span class="o">.</span><span class="n">parent</span>    <span class="c1"># documents node</span>
<span class="n">node</span><span class="o">.</span><span class="n">root</span>      <span class="c1"># root node</span>
</pre></div>
</div>
<p><strong>Pyramid Integration</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">global_config</span><span class="p">,</span> <span class="o">**</span><span class="n">settings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;WSGI Application Factory.&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">Configurator</span><span class="p">(</span><span class="n">root_factory</span><span class="o">=</span><span class="n">get_root</span><span class="p">,</span> <span class="n">settings</span><span class="o">=</span><span class="n">settings</span><span class="p">)</span>

    <span class="c1"># Authentication (cookie-based)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authentication_policy</span><span class="p">(</span><span class="n">auth_tkt_factory</span><span class="p">(</span><span class="o">...</span><span class="p">))</span>

    <span class="c1"># Authorization (ACL-based)</span>
    <span class="n">config</span><span class="o">.</span><span class="n">set_authorization_policy</span><span class="p">(</span><span class="n">acl_factory</span><span class="p">())</span>

    <span class="c1"># Plugin loading</span>
    <span class="k">for</span> <span class="n">plugin</span> <span class="ow">in</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;cone.plugins&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
        <span class="n">config</span><span class="o">.</span><span class="n">load_zcml</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">plugin</span><span class="si">}</span><span class="s1">:configure.zcml&#39;</span><span class="p">)</span>

    <span class="c1"># Execute main hooks</span>
    <span class="k">for</span> <span class="n">hook</span> <span class="ow">in</span> <span class="n">main_hooks</span><span class="p">:</span>
        <span class="n">hook</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">global_config</span><span class="p">,</span> <span class="n">settings</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">config</span><span class="o">.</span><span class="n">make_wsgi_app</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Tile-based UI (cone.tile)</strong></p>
<p>Tiles are composable view components:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@tile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;templates/content.pt&#39;</span><span class="p">,</span> <span class="n">permission</span><span class="o">=</span><span class="s1">&#39;view&#39;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContentTile</span><span class="p">(</span><span class="n">Tile</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Main Tiles</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Tile</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">layout</span></code></p></td>
<td><p>Main layout container</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mainmenu</span></code></p></td>
<td><p>Navigation menu from node hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pathbar</span></code></p></td>
<td><p>Breadcrumb navigation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">content</span></code></p></td>
<td><p>Main content area</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">listing</span></code></p></td>
<td><p>Child listing with sorting/batching</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sharing</span></code></p></td>
<td><p>ACL editor table</p></td>
</tr>
</tbody>
</table>
<p><strong>Security Model</strong></p>
<p>ACL-based authorization:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">DEFAULT_ACL</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="s1">&#39;system.Authenticated&#39;</span><span class="p">,</span> <span class="n">authenticated_permissions</span><span class="p">),</span>
    <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="s1">&#39;role:viewer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">]),</span>
    <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="s1">&#39;role:editor&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">]),</span>
    <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="s1">&#39;role:admin&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="s1">&#39;edit&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="s1">&#39;manage&#39;</span><span class="p">]),</span>
    <span class="p">(</span><span class="n">Allow</span><span class="p">,</span> <span class="s1">&#39;role:manager&#39;</span><span class="p">,</span> <span class="n">ALL_PERMISSIONS</span><span class="p">),</span>
    <span class="p">(</span><span class="n">Deny</span><span class="p">,</span> <span class="n">Everyone</span><span class="p">,</span> <span class="n">ALL_PERMISSIONS</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Authentication sources (in order):</p>
<ol class="arabic simple">
<li><p>Admin user (via settings)</p></li>
<li><p>Custom authenticator</p></li>
<li><p>UGM backend (Users/Groups Management)</p></li>
</ol>
<p><strong>Action System</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@tile</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;contexttoolbar&#39;</span><span class="p">,</span> <span class="n">permission</span><span class="o">=</span><span class="s1">&#39;view&#39;</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ContextToolbar</span><span class="p">(</span><span class="n">Toolbar</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ActionView</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ActionEdit</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">action_delete</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ActionDelete</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id11">
<h3>Main Classes<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p><strong>Model Classes (model.py)</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AppNode</span></code></p></td>
<td><p>Behavior for IApplicationNode interface</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">BaseNode</span></code></p></td>
<td><p>Node with storage, lifecycle, and common
behaviors</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FactoryNode</span></code></p></td>
<td><p>Node with dynamic children via factories</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AppRoot</span></code></p></td>
<td><p>Root node of the application</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AppSettings</span></code></p></td>
<td><p>Container for plugin settings</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AdapterNode</span></code></p></td>
<td><p>Adapts external models into node hierarchy</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Properties</span></code></p></td>
<td><p>Dynamic node properties container</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Metadata</span></code></p></td>
<td><p>Display metadata (title, description, icon)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LayoutConfig</span></code></p></td>
<td><p>Configuration for page layout</p></td>
</tr>
</tbody>
</table>
<p><strong>Security Classes (security.py)</strong></p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">OwnerSupport</span></code></p></td>
<td><p>Behavior for owner tracking</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">PrincipalACL</span></code></p></td>
<td><p>Behavior for principal-specific ACLs</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AdapterACL</span></code></p></td>
<td><p>ACL derivation from registered adapters</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ACLRegistry</span></code></p></td>
<td><p>Registry for ACL lookup</p></td>
</tr>
</tbody>
</table>
</section>
<section id="plugin-development">
<h3>Plugin Development<a class="headerlink" href="#plugin-development" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># myapp/__init__.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cone.app</span><span class="w"> </span><span class="kn">import</span> <span class="n">main_hook</span><span class="p">,</span> <span class="n">register_entry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cone.app.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseNode</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyContentNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="nd">@main_hook</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_plugin_hook</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">global_config</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
    <span class="c1"># Register entry node</span>
    <span class="n">register_entry</span><span class="p">(</span><span class="s1">&#39;mycontent&#39;</span><span class="p">,</span> <span class="n">MyContentNode</span><span class="p">)</span>

    <span class="c1"># Scan views</span>
    <span class="n">config</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="s1">&#39;myapp.browser&#39;</span><span class="p">)</span>

    <span class="c1"># Static resources</span>
    <span class="n">config</span><span class="o">.</span><span class="n">add_static_view</span><span class="p">(</span><span class="s1">&#39;myapp-static&#39;</span><span class="p">,</span> <span class="s1">&#39;myapp:static&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>INI Configuration</strong></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[app:main]</span>
<span class="na">use</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">egg:cone.app</span>

<span class="na">cone.plugins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">myapp</span>
<span class="na">cone.root.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">My Application</span>
<span class="na">cone.admin_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">admin</span>
<span class="na">cone.admin_password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">secret</span>

<span class="na">ugm.backend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">file</span>
<span class="na">ugm.users_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">%(here)s/var/users.txt</span>
</pre></div>
</div>
</section>
<section id="id12">
<h3>Extension Mechanisms<a class="headerlink" href="#id12" title="Link to this heading">#</a></h3>
<p><strong>Entry/Config Registration</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Register top-level node</span>
<span class="n">register_entry</span><span class="p">(</span><span class="s1">&#39;documents&#39;</span><span class="p">,</span> <span class="n">DocumentsNode</span><span class="p">)</span>

<span class="c1"># Register settings node</span>
<span class="n">register_config</span><span class="p">(</span><span class="s1">&#39;myapp_settings&#39;</span><span class="p">,</span> <span class="n">MySettingsNode</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>node_info Decorator</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@node_info</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;document&#39;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Document&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;A document node&#39;</span><span class="p">,</span>
    <span class="n">addables</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;document&#39;</span><span class="p">,</span> <span class="s1">&#39;folder&#39;</span><span class="p">],</span>
    <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;glyphicon glyphicon-file&#39;</span>
<span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DocumentNode</span><span class="p">(</span><span class="n">BaseNode</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p><strong>layout_config Decorator</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@layout_config</span><span class="p">(</span><span class="n">DocumentNode</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DocumentLayout</span><span class="p">(</span><span class="n">LayoutConfig</span><span class="p">):</span>
    <span class="n">mainmenu</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">sidebar_left</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;navtree&#39;</span><span class="p">]</span>
    <span class="n">sidebar_left_grid_width</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">content_grid_width</span> <span class="o">=</span> <span class="mi">9</span>
</pre></div>
</div>
<p><strong>Main Hooks</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@main_hook</span>
<span class="k">def</span><span class="w"> </span><span class="nf">setup_resources</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">global_config</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
    <span class="c1"># Executed at app startup</span>
    <span class="n">cone</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">css</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;myapp-static/styles.css&#39;</span><span class="p">)</span>
    <span class="n">cone</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">js</span><span class="o">.</span><span class="n">public</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;myapp-static/app.js&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id13">
<h3>Design Patterns<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Pattern</p></th>
<th class="head"><p>Usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Composite</strong></p></td>
<td><p>Node tree for content</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Factory</strong></p></td>
<td><p>Node factories, app factory</p></td>
</tr>
<tr class="row-even"><td><p><strong>Registry</strong></p></td>
<td><p>ACL registry, entry registry</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Adapter</strong></p></td>
<td><p>Zope adapters for traversal, ACLs</p></td>
</tr>
<tr class="row-even"><td><p><strong>Template Method</strong></p></td>
<td><p>Tile rendering with overridable methods</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Strategy</strong></p></td>
<td><p>Interchangeable UGM backends</p></td>
</tr>
<tr class="row-even"><td><p><strong>Observer</strong></p></td>
<td><p>Lifecycle events</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Command</strong></p></td>
<td><p>Action system</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="cone-feature-packages">
<h2>cone.* - Feature Packages<a class="headerlink" href="#cone-feature-packages" title="Link to this heading">#</a></h2>
<p>Additional cone packages provide specialized features:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Package</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.tile</span></code></p></td>
<td><p>Tile-based UI composition system</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cone.ugm</span></code></p></td>
<td><p>User/group management UI with LDAP/SQL backends</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.ldap</span></code></p></td>
<td><p>LDAP backend integration for cone.app</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cone.sql</span></code></p></td>
<td><p>SQL database integration with SQLAlchemy</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.zodb</span></code></p></td>
<td><p>ZODB backend integration for persistent nodes</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cone.calendar</span></code></p></td>
<td><p>Calendar functionality with event management</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.charts</span></code></p></td>
<td><p>Chart visualizations with various chart types</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cone.fileupload</span></code></p></td>
<td><p>File upload handling with progress tracking</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.firebase</span></code></p></td>
<td><p>Firebase integration for push notifications</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cone.maps</span></code></p></td>
<td><p>Map widgets with location data</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cone.tokens</span></code></p></td>
<td><p>Token management for secure operations</p></td>
</tr>
</tbody>
</table>
</section>
<section id="architecture-summary">
<h2>Architecture Summary<a class="headerlink" href="#architecture-summary" title="Link to this heading">#</a></h2>
<section id="architecture-principles">
<h3>Architecture Principles<a class="headerlink" href="#architecture-principles" title="Link to this heading">#</a></h3>
<p>The packages share common architecture principles:</p>
<ol class="arabic simple">
<li><p><strong>Composition over Inheritance</strong> - Behaviors/blueprints instead of class hierarchies</p></li>
<li><p><strong>Explicit over Implicit</strong> - Explicit instructions for class composition</p></li>
<li><p><strong>Pipeline-based Processing</strong> - Chain of responsibility for extensibility</p></li>
<li><p><strong>Interface Segregation</strong> - Small, focused interfaces/behaviors</p></li>
<li><p><strong>Fail Fast</strong> - Errors at definition/creation time instead of runtime</p></li>
<li><p><strong>Node Traversal</strong> - Tree structures as common data model</p></li>
</ol>
</section>
<section id="dependency-graph">
<h3>Dependency Graph<a class="headerlink" href="#dependency-graph" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cone.app
   ├── cone.tile (tile rendering)
   ├── yafowil (forms)
   │     └── webresource (resource management)
   ├── node (content model + widget tree structure)
   │     └── plumber (behavior composition)
   ├── Pyramid (web framework)
   └── zope.interface (component architecture)
</pre></div>
</div>
<p><strong>Direct node usage in cone.app:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">AppRoot</span></code>, <code class="docutils literal notranslate"><span class="pre">BaseNode</span></code>, <code class="docutils literal notranslate"><span class="pre">FactoryNode</span></code> etc. are based on node behaviors</p></li>
<li><p>Traversal-based URL routing via the node hierarchy</p></li>
<li><p>Content model is a node tree with <code class="docutils literal notranslate"><span class="pre">__name__</span></code>/<code class="docutils literal notranslate"><span class="pre">__parent__</span></code></p></li>
<li><p>yafowil uses node for its widget tree structure</p></li>
</ul>
</section>
<section id="layer-architecture">
<h3>Layer Architecture<a class="headerlink" href="#layer-architecture" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>┌────────────────────────────────────────────────────────────────────┐
│                        Application Layer                           │
│  cone.app plugins, custom nodes, custom tiles, business logic      │
├────────────────────────────────────────────────────────────────────┤
│                        Framework Layer                             │
│  cone.app (web app), cone.tile (UI), yafowil (forms)               │
├────────────────────────────────────────────────────────────────────┤
│                      Data Structure Layer                          │
│  node (trees), node.ext.* (backend adapters)                       │
├────────────────────────────────────────────────────────────────────┤
│                        Meta Layer                                  │
│  plumber (behavior composition), zope.interface (contracts)        │
├────────────────────────────────────────────────────────────────────┤
│                      Infrastructure Layer                          │
│  Pyramid, WSGI, Python                                             │
└────────────────────────────────────────────────────────────────────┘
</pre></div>
</div>
</section>
<section id="when-to-use-which-package">
<h3>When to Use Which Package<a class="headerlink" href="#when-to-use-which-package" title="Link to this heading">#</a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Use Case</p></th>
<th class="head"><p>Package</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Web application with UI, security, and plugin
system</p></td>
<td><p>cone.app</p></td>
</tr>
<tr class="row-odd"><td><p>Compose classes with configurable behaviors</p></td>
<td><p>plumber</p></td>
</tr>
<tr class="row-even"><td><p>Model hierarchical data structures (trees)</p></td>
<td><p>node</p></td>
</tr>
<tr class="row-odd"><td><p>Build web forms</p></td>
<td><p>yafowil</p></td>
</tr>
<tr class="row-even"><td><p>Expose backend data as tree (LDAP, FS, DB)</p></td>
<td><p>node.ext.*</p></td>
</tr>
<tr class="row-odd"><td><p>Bootstrap-styled forms</p></td>
<td><p>yafowil.bootstrap</p></td>
</tr>
<tr class="row-even"><td><p>User/group management</p></td>
<td><p>cone.ugm</p></td>
</tr>
<tr class="row-odd"><td><p>SQL backend for cone.app</p></td>
<td><p>cone.sql</p></td>
</tr>
<tr class="row-even"><td><p>ZODB backend for cone.app</p></td>
<td><p>cone.zodb</p></td>
</tr>
</tbody>
</table>
</section>
<section id="standalone-usage">
<h3>Standalone Usage<a class="headerlink" href="#standalone-usage" title="Link to this heading">#</a></h3>
<p>The packages are modular and can be used independently:</p>
<ul class="simple">
<li><p><strong>plumber</strong> - Standalone for behavior composition in any project</p></li>
<li><p><strong>node</strong> - Standalone for tree structures without web context</p></li>
<li><p><strong>yafowil</strong> - Standalone for forms in any web framework</p></li>
<li><p><strong>cone.tile</strong> - Standalone for tile-based rendering in Pyramid apps</p></li>
</ul>
</section>
</section>
</section>


      </div>

    
  <div class="cs-local-toc mx-4 mt-4 mb-5 my-md-0 ps-xl-3 mb-lg-5 text-muted">
    <strong class="d-block h6 mb-2 pb-2 border-bottom">On this page</strong>
    <nav id="TableOfContents">
      <ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#plumber-behavior-composition">plumber - Behavior Composition</a><ul>
<li><a class="reference internal" href="#package-structure">Package Structure</a></li>
<li><a class="reference internal" href="#core-concepts">Core Concepts</a></li>
<li><a class="reference internal" href="#main-classes">Main Classes</a></li>
<li><a class="reference internal" href="#usage-example">Usage Example</a></li>
<li><a class="reference internal" href="#design-patterns">Design Patterns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#node-tree-data-structures">node - Tree Data Structures</a><ul>
<li><a class="reference internal" href="#id1">Package Structure</a></li>
<li><a class="reference internal" href="#id2">Core Concepts</a></li>
<li><a class="reference internal" href="#pre-built-node-classes">Pre-built Node Classes</a></li>
<li><a class="reference internal" href="#custom-node-creation">Custom Node Creation</a></li>
<li><a class="reference internal" href="#id3">Design Patterns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#node-ext-backend-extensions">node.ext.* - Backend Extensions</a></li>
<li><a class="reference internal" href="#yafowil-form-library">yafowil - Form Library</a><ul>
<li><a class="reference internal" href="#id4">Package Structure</a></li>
<li><a class="reference internal" href="#id5">Core Concepts</a></li>
<li><a class="reference internal" href="#id6">Main Classes</a></li>
<li><a class="reference internal" href="#id7">Usage Example</a></li>
<li><a class="reference internal" href="#extension-mechanisms">Extension Mechanisms</a></li>
<li><a class="reference internal" href="#id8">Design Patterns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#yafowil-widget-widget-extensions">yafowil.widget.* - Widget Extensions</a></li>
<li><a class="reference internal" href="#cone-app-web-application-framework">cone.app - Web Application Framework</a><ul>
<li><a class="reference internal" href="#id9">Package Structure</a></li>
<li><a class="reference internal" href="#id10">Core Concepts</a></li>
<li><a class="reference internal" href="#id11">Main Classes</a></li>
<li><a class="reference internal" href="#plugin-development">Plugin Development</a></li>
<li><a class="reference internal" href="#id12">Extension Mechanisms</a></li>
<li><a class="reference internal" href="#id13">Design Patterns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cone-feature-packages">cone.* - Feature Packages</a></li>
<li><a class="reference internal" href="#architecture-summary">Architecture Summary</a><ul>
<li><a class="reference internal" href="#architecture-principles">Architecture Principles</a></li>
<li><a class="reference internal" href="#dependency-graph">Dependency Graph</a></li>
<li><a class="reference internal" href="#layer-architecture">Layer Architecture</a></li>
<li><a class="reference internal" href="#when-to-use-which-package">When to Use Which Package</a></li>
<li><a class="reference internal" href="#standalone-usage">Standalone Usage</a></li>
</ul>
</li>
</ul>

    </nav>
  </div>
    
    </main>
  </div><div class="container footer" role="contentinfo">
  <footer class="d-flex flex-wrap justify-content-between align-items-center pt-2 my-4 border-top"><ul class="pb-2 mb-3 nav container border-bottom">
  <li class="nav-item col-md-6 col">
    <a href="introduction.html"
       title="previous chapter"
       class="nav-link px-2 text-muted previous-chapter">Introduction</a>
  </li>
  <li class="nav-item col-md-6 col text-end">
    <a href="package_validation.html"
       title="next chapter"
       class="nav-link px-2 text-muted next-chapter">Package Validation</a>
  </li>
</ul>
      <div class="container text-center text-muted pt-2 pb-2">
          &#169; Copyright 2021-2025, Conestack Contributors.
      </div>
      <div class="container text-center text-muted pt-2 pb-2">
        Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
      </div>
  </footer>
</div>

  </body>
</html>